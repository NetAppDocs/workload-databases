---
sidebar: sidebar
permalink: requirements-databases.html  
keywords: requirements, basic mode, read mode, automate mode 
summary: Databases has three different modes that have different requirements. 
---
= Requirements for databases
:icons: font
:imagesdir: ./media/

[.lead]
Databases has three different modes with different requirements. 

== Basic mode
no permissions required, grab an empty template to be filled outside WF using the CloudFormation (AWS) console

== Read mode
In read mode, you'll need some read-only permissions in AWS CloudFormation.

To use a ready-to-execute template that you fill out in Workload Factory for execution with AWS CloudFormation, you'll need AWS account credentials with some read-only permissions.  

Run the following JSON script to add read mode permissions:

[source,JSON]
----
    "view": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Sid": "CommonGroup",
                "Effect": "Allow",
                "Action": [
                    "sns:ListTopics",
                    "ec2:DescribeInstances",
                    "ec2:DescribeVpcs",
                    "ec2:DescribeSubnets",
                    "ec2:DescribeSecurityGroups",
                    "ec2:DescribeImages",
                    "ec2:DescribeRegions",
                    "ec2:DescribeRouteTables",
                    "ec2:DescribeKeyPairs",
                    "ec2:DescribeNetworkInterfaces",
                    "ec2:DescribeInstanceTypes",
                    "ec2:DescribeVpcEndpoints",
                    "ec2:DescribeInstanceTypeOfferings",
                    "kms:ListAliases",
                    "kms:ListKeys",
                    "kms:DescribeKey",
                    "cloudformation:ListStacks",
                    "ds:DescribeDirectories",
                    "fsx:DescribeVolumes",
                    "fsx:DescribeBackups",
                    "fsx:DescribeStorageVirtualMachines",
                    "fsx:DescribeFileSystems",
                    "servicequotas:ListServiceQuotas",
                    "ssm:GetParametersByPath",
                    "ssm:GetCommandInvocation",
                    "ssm:SendCommand",
                    "ssm:GetConnectionStatus",
                    "fsx:ListTagsForResource"
                ],
                "Resource": ["*"]
            },
            {
                "Sid": "SSMParameterStore",
                "Effect": "Allow",
                "Action": [
                    "ssm:GetParameter", 
                    "ssm:GetParameters", 
                    "ssm:PutParameter",
                    "ssm:DeleteParameters"
                ],
                "Resource": "arn:aws:ssm:*:*:parameter/netapp/wlmdb/*"
            }
        ]
    }
}
----

== Automate mode 
In automate mode, you'll need AWS credentials, AWS CloudFOrmation permissions, and SSM connectivity.

To deploy and manage your workload resources within Workload Factory, you must have:

* AWS account credentials 
* AWS CloudFormation permissions 
* A deployed Amazon EC2 instance with an installed AWS Systems Manager Agent. The SSM Agent gives Workload Factory access to database host machines for installing, patching, or fetching data. 

Run the following JSON script to add automate mode permissions:

[source,JSON]
----
{
    "_comment": "",
    "operate": {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Sid": "EC2Group",
                "Effect": "Allow",
                "Action": [
                    "ec2:AllocateAddress",
                    "ec2:AllocateHosts",
                    "ec2:AssignPrivateIpAddresses",
                    "ec2:AssociateAddress",
                    "ec2:AssociateRouteTable",
                    "ec2:AssociateSubnetCidrBlock",
                    "ec2:AssociateVpcCidrBlock",
                    "ec2:AttachInternetGateway",
                    "ec2:AttachNetworkInterface",
                    "ec2:AttachVolume",
                    "ec2:AuthorizeSecurityGroupEgress",
                    "ec2:AuthorizeSecurityGroupIngress",
                    "ec2:CreateVolume",
                    "ec2:DeleteNetworkInterface",
                    "ec2:DeleteSecurityGroup",
                    "ec2:DeleteTags",
                    "ec2:DeleteVolume",
                    "ec2:DetachNetworkInterface",
                    "ec2:DetachVolume",
                    "ec2:DisassociateAddress",
                    "ec2:DisassociateIamInstanceProfile",
                    "ec2:DisassociateRouteTable",
                    "ec2:DisassociateSubnetCidrBlock",
                    "ec2:DisassociateVpcCidrBlock",
                    "ec2:ModifyInstanceAttribute",
                    "ec2:ModifyInstancePlacement",
                    "ec2:ModifyNetworkInterfaceAttribute",
                    "ec2:ModifySubnetAttribute",
                    "ec2:ModifyVolume",
                    "ec2:ModifyVolumeAttribute",
                    "ec2:ReleaseAddress",
                    "ec2:ReplaceRoute",
                    "ec2:ReplaceRouteTableAssociation",
                    "ec2:RevokeSecurityGroupEgress",
                    "ec2:RevokeSecurityGroupIngress",
                    "ec2:StartInstances",
                    "ec2:StopInstances"
                ],
                "Resource": "*",
                "Condition": {
                    "StringLike": {
                        "ec2:ResourceTag/aws:cloudformation:stack-name": "WLMDB*"
                    }
                }
            },
            {
                "Sid": "FSxNGroup",
                "Effect": "Allow",
                "Action": ["fsx:TagResource"],
                "Resource": "*",
                "Condition": {
                    "StringLike": {
                        "aws:ResourceTag/aws:cloudformation:stack-name": "WLMDB*"
                    }
                }
            },
            {
                "Sid": "CommonGroup",
                "Effect": "Allow",
                "Action": [
                    "cloudformation:CreateStack",
                    "cloudformation:DescribeStackEvents",
                    "cloudformation:DescribeStacks",
                    "cloudformation:ListStacks",
                    "cloudformation:ValidateTemplate",
                    "ds:DescribeDirectories",
                    "ec2:CreateLaunchTemplate",
                    "ec2:CreateLaunchTemplateVersion",
                    "ec2:CreateNetworkInterface",
                    "ec2:CreateSecurityGroup",
                    "ec2:CreateTags",
                    "ec2:CreateVpcEndpoint",
                    "ec2:Describe*",
                    "ec2:Get*",
                    "ec2:RunInstances",
                    "ec2:ModifyVpcAttribute",
                    "ec2messages:*",
                    "fsx:CreateFileSystem",
                    "fsx:CreateStorageVirtualMachine",
                    "fsx:CreateVolume",
                    "fsx:Describe*",
                    "fsx:List*",
                    "kms:CreateGrant",
                    "kms:Describe*",
                    "kms:List*",
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:DescribeLog*",
                    "logs:GetLog*",
                    "logs:ListLogDeliveries",
                    "logs:PutLogEvents",
                    "logs:TagResource",
                    "servicequotas:ListServiceQuotas",
                    "sns:ListTopics",
                    "sns:Publish",
                    "ssm:Describe*",
                    "ssm:Get*",
                    "ssm:List*",
                    "ssm:PutComplianceItems",
                    "ssm:PutConfigurePackageResult",
                    "ssm:PutInventory",
                    "ssm:SendCommand",
                    "ssm:UpdateAssociationStatus",
                    "ssm:UpdateInstanceAssociationStatus",
                    "ssm:UpdateInstanceInformation",
                    "ssmmessages:*"
                ],
                "Resource": "*"
            },
            {
                "Sid": "ArnGroup",
                "Effect": "Allow",
                "Action": [
                    "cloudformation:SignalResource"
                ],
                "Resource": [
                    "arn:aws:cloudformation:*:*:stack/WLMDB*", 
                    "arn:aws:logs:*:*:log-group:WLMDB*"
                ]
            },
            {
                "Sid": "IAMGroup",
                "Effect": "Allow",
                "Action": [
                    "iam:AddRoleToInstanceProfile",
                    "iam:CreateInstanceProfile",
                    "iam:CreateRole",
                    "iam:DeleteInstanceProfile",
                    "iam:GetPolicy",
                    "iam:GetPolicyVersion",
                    "iam:GetRole",
                    "iam:GetRolePolicy",
                    "iam:GetUser",
                    "iam:PutRolePolicy",
                    "iam:RemoveRoleFromInstanceProfile",
                    "iam:SimulatePrincipalPolicy"
                ],
                "Resource": "*"
            },
            {
                "Sid": "IAMGroup1",
                "Effect": "Allow",
                "Action": "iam:CreateServiceLinkedRole",
                "Resource": "*",
                "Condition": {
                    "StringLike": {
                        "iam:AWSServiceName": "ec2.amazonaws.com"
                    }
                }
            },
            {
                "Sid": "IAMGroup2",
                "Effect": "Allow",
                "Action": "iam:PassRole",
                "Resource": "*",
                "Condition": {
                    "StringEquals": {
                        "iam:PassedToService": "ec2.amazonaws.com"
                    }
                }
            },
            {
                "Sid": "SSMParameterStore",
                "Effect": "Allow",
                "Action": [
                    "ssm:GetParameter", 
                    "ssm:GetParameters", 
                    "ssm:PutParameter",
                    "ssm:DeleteParameters"
                ],
                "Resource": "arn:aws:ssm:*:*:parameter/netapp/wlmdb/*"
            }
        ]
    },
----    
